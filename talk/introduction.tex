
\begin{frame}
  \frametitle{Évolution des Processeurs Graphiques}
  \begin{center}
    \begin{tikzpicture}[yscale=-1]
      % \draw[help lines] (0,0) grid (15,6);
      % > latex arroxw
      \draw[line width=10pt,-latex] (1.5,1) .. controls +(1,4) and +(-5,-0) .. +(10,4);
      \node at (1.5,1) {\includegraphics[scale=.1]{images/evans-sutherland.jpg}};
      \node [anchor=south] at (1.5,0) {Evan \& Sutherland};
      \node at (3,3.25) {\includegraphics[scale=.1]{images/sgi-o2-workstation.jpg}};
      \node [anchor=north] at (2.5,4.25) {SGI Workstation};
      \node at (6,4.75) {\includegraphics[scale=.5]{images/oxygen.png}};
      \node [anchor=north] at (6,5.25) {Accélerateur Graphique};
      \node at (9,5) {\includegraphics[scale=.03]{images/nvidia-gforce.png}};
      \node [anchor=south,align=center] at (9,4.5) {Nvidia GeForce 256\\ $1^\text{er}$ GPU};
      \node [anchor=west,align=left] at (11.5,5) {\textbf{General Purpose} \\ \textbf{GPU}};
      \draw (14.5,0) -- +(.01,0); % hack
    \end{tikzpicture}
  \end{center}
  \begin{textblock}{12}(5,2)
    \textbf{Convergence}
    \begin{itemize}
    \item du hardware professionnel et grand-publique
    \item des processeurs graphiques et de flux
    \item des plateformes~: de l'embarqué au super-calculateur 
    \end{itemize}
  \end{textblock}
  \note{
    \begin{enumerate}
    \item des pionniers aux machines spécifiques
    \item aux stations de travail professionnels
    \item à présent plus de distinction
    \end{enumerate}
  }
\end{frame}

\begin{frame}
  \frametitle{Présentation des GPUs~: processeur de flux}
  % dessin flux de données traversant la page
  \begin{center}
    \begin{tabular}{cc}
      Intel Haswell Die & Nvidia Kepler Die \\[5mm]
      \includegraphics[height=.3\textheight]{images/intel-haswell-die.jpg} &
      \includegraphics[height=.3\textheight]{images/nvidia-kepler-die.jpg}
    \end{tabular} \\[5mm]
    Architecture de calcule hautement parallèle \\
    couplé à une mémoire rapide (GDDR5)
  \end{center}
  \begin{tikzpicture}[remember picture, overlay, mystyle/.style={-latex, line width=1pt}] % run twice
    \node (o1) at ($(current page.south west) + (2.5,6.25)$) {\tiny GPU core};
    \draw[mystyle] (o1) -- ++(.5,-.5);
    \node (o2) at ($(current page.south west) + (4.5,6.25)$) {\tiny CPU core};
    \draw[mystyle] (o2) -- ++(1,-1);
    \node (o3) at ($(current page.south west) + (6,3.25)$) {\tiny L3 Cache};
    \draw[mystyle] (o3) -- ++(1,.75);
  \end{tikzpicture}
  \note{
    \begin{enumerate}
    \item c'est quoi un GPU
    \item CPU~: usage générique
    \item SIMD AVX2 256-bit 8x float 32-bit
    \item flux de données
    \item pas la même architecture, cf.\ silicium
    \end{enumerate}
  }
\end{frame}

\begin{frame}
  \frametitle{Usage des GPUs}
  % keywords picture
  % pgf mindmap cf. p75
  \begin{columns}
    \begin{column}{.25\textwidth}
      \begin{center}
        \includegraphics[width=1.\textwidth]{images/game.jpg} \\[5mm]
        \includegraphics[width=1.\textwidth]{images/blender.jpg}
      \end{center}
    \end{column}
    \begin{column}{.25\textwidth}
      \begin{center}
        \includegraphics[width=1.\textwidth]{images/solidworks.jpg} \\[5mm]
        \includegraphics[width=.8\textwidth]{images/tiger.jpg}
      \end{center}
    \end{column}
    \begin{column}{.5\textwidth}
      \begin{itemize}
      \item Moteur de jeu % Game Engine
      \item Modeleur \textbf{3D}
      \item CAO
      \item \textbf{Visualisation} scientifique
      \item \textbf{Interface graphique} \\
        e.g.\ Qt QML, KDE Plasma
      \item \textbf{2D} avec accélération matériel
      \item \textbf{Calcul}~: CUDA, OpenCL
      \end{itemize}
    \end{column}
  \end{columns}
  \note{
    \begin{enumerate}
      \item Qu'est ce que l'on peut faire avec un GPU?
      \item OpenVG, SVG, Display Postscript
    \end{enumerate}
  }
\end{frame}

\begin{frame}
  \frametitle{Présentation de l'API OpenGL}
  % même titre que ...
  \begin{columns}
    \begin{column}{.2\textwidth}
      \begin{center}
        \includegraphics[width=1.\textwidth]{images/khronos-logos/OpenGL/OpenGL_500.jpg} \\
        \includegraphics[width=1.\textwidth]{images/khronos-logos/OpenGL_ES/OpenGL-ES_500.jpg} \\
        \includegraphics[width=1.\textwidth]{images/khronos-logos/WebGL/WebGL_500.jpg} \\
        \includegraphics[width=1.\textwidth]{images/khronos-logos/Khronos_Group/Khronos_Group_500.jpg}
      \end{center}
    \end{column}
    \begin{column}{.8\textwidth}
      \begin{itemize}
      \item Un standard \textbf{ouvert} piloté par le groupe Khronos
      \item La seule API \textbf{cross-platforme} et \textbf{cross-vendor} % cross / multi
      \item L'API de facto de GNU/Linux et d'Android
      \item Une API orientée desktop (OpenGL) et embarqué (OpenGL ES)
      \item et aussi orientée web (WebGL)
      \item \alert{Mais pas un idéale} cf.\ \href{https://www.khronos.org/assets/uploads/developers/library/2014-siggraph-bof/OpenGL-Ecosystem-BOF_Aug14.pdf}{Siggraph 2014 Khronos talk}
        % \url{https://www.khronos.org/developers/library/2014-siggraph-bof}
      \end{itemize}
    \end{column}
  \end{columns}
  \note{
    \begin{enumerate}
    \item C'est quoi OpenGL?
    \item Next generation OpenGL initiative
    \end{enumerate}
  }
\end{frame}

\begin{frame}
  \frametitle{Évolution de l'API OpenGL}
  \begin{center}
    \includegraphics[width=.6\textwidth]{figures/opengl-release-date.pdf} % ,transparent
  \end{center}
  \note{
    \begin{enumerate}
    \item 20 ans d'histoire
    \item dynamique des releases
    \end{enumerate}
  }
\end{frame}

\begin{frame}
  \frametitle{Programmable Pipeline}
  \note{
    \begin{enumerate}
    \item expliquer le passage fixed pipeline $\longrightarrow$ programmable pipeline
    \item concepts
    \item comment on utilise OpenGL depuis Python
    \end{enumerate}
  }
\end{frame}

\begin{frame}
  \frametitle{Implémentations}
  \begin{center}
    \includegraphics[width=.6\textwidth]{figures/mesa-status.pdf} % ,transparent
  \end{center}
  \note{
    \begin{enumerate}
    \item Quelle API cibler pour développer une application?
    \end{enumerate}
  }
\end{frame}

\begin{frame}
  \frametitle{Outils pour interfacer du code C avec Python}
  \begin{center}
    % \begin{tabular}{|c|c|c|}
    \begin{tabular}{ccc}
      & Avantages & Inconvénients \\[.5em]
      %
      API C Python &
      \begin{minipage}[t]{.2\linewidth}
        \tiny
        \begin{itemize}
        \item au coeur de CPython
        \end{itemize}
      \end{minipage} &
      \begin{minipage}[t]{.45\linewidth}
        \tiny
        \begin{itemize}
        \item implémentation manuelle
        \end{itemize}
      \end{minipage} \\[1em] % ???
      %
      SWIG &
      \begin{minipage}[t]{.2\linewidth}
        \tiny
        \begin{itemize}
        \item \textbf{supporte \Cpp}
        \item \textbf{header parser}
        \item multi-langages
        \end{itemize}
      \end{minipage} &
      \begin{minipage}[t]{.45\linewidth}
        \tiny
        \begin{itemize}
        \item pas optimisé pour un langage (Python)
        \item le mécanisme de macros (typemap) engendre du code bloat
        \item requiert un compilateur
        \item pypy ne supporte pas l'API C
        \end{itemize}
      \end{minipage} \\[1em] % ???
      %
      Ctypes &
      \begin{minipage}[t]{.2\linewidth}
        \tiny
        \begin{itemize}
        \item \textbf{inclus dans CPython}
        \end{itemize}
      \end{minipage} &
      \begin{minipage}[t]{.45\linewidth}
        \tiny
        \begin{itemize}
          \item non supporté par pypy
        \end{itemize}
      \end{minipage} \\[1em]
      %
      Cffi &
      \begin{minipage}[t]{.2\linewidth}
        \tiny
        \begin{itemize}
        \item \textbf{header parser}
        \item \textbf{ABI et API}
        \item \textbf{supporté par pypy}
        \end{itemize}
      \end{minipage} &
      \begin{minipage}[t]{.45\linewidth}
        \tiny
        \begin{itemize}
        \item ???
        \end{itemize}
      \end{minipage}
    \end{tabular} \\[1em]
    \alert{Cffi est la solution idéale pour interfacer du C} \\[.5em]
    \alert{SWIG est une solution pour interfacer du \Cpp}
  \end{center}
  \note{
    \begin{enumerate}
    \item
    \end{enumerate}
  }
\end{frame}

\begin{frame}[fragile]
  \frametitle{\href{http://pyopengl.sourceforge.net}{PyOpenGL}~: la réference actuelle}
  3 générations~:
  \begin{description}
    \item[V1.x] C extension basé sur l'API C Python {\tiny (David Ascher et. al)}
    \item[V2.x] généré par SWIG {\tiny (Tarn Weisner Burton)}
    \item[V3.x] basé sur ctypes {\tiny (\href{http://www.vrplumber.com}{Mike C. Fletcher})}
      % -3.1.0
      \begin{itemize}
      \item \textbf{compatibilité ascendante avec la V2.x}
      \item implémente un parser de fichier d'en-tête
      \item PyOpenGL~: 2000 fichiers \small({\emph{en comptant les extensions})}
      \item PyOpenGL-accelerate
      \end{itemize}
    \end{description}
    \vspace{1em}
    et des alternatives~:
    \begin{description}
    \item[\href{http://www.pyglet.org}{Pyglet}] a cross-platform windowing and multimedia library
    \item[\href{http://vispy.org}{Vispy}] a high-performance interactive 2D/3D data visualization library
    \end{description}
  \note{
    \begin{enumerate}
    \item
    \end{enumerate}
  }
\end{frame}

\begin{frame}[fragile]
  \frametitle{PyOpenGL~: ce qui pêche}
  Exemples de difficultés rencontrées au cours du temps~:
    \begin{itemize}
    \item absence de constante~:%
      {\tiny\begin{verbatim}GL.GL_RG_INTEGER = OpenGL.constant.Constant('GL_RG_INTEGER', 0x8228)}\end{verbatim}}
    \item \code{glGetObjectParameteriv} est ici~:%
      {\tiny\begin{verbatim}import OpenGL.GL.ARB.shader_objects as GL_SO\end{verbatim}}
    \item \code{glGetActiveUniformBlockName} n'a pas de Pythonic wrapper~:
{\tiny%
\begin{verbatim}
name = ctypes.create_string_buffer(max_name_length)
name_length = OpenGL.arrays.GLsizeiArray.zeros((1,))
GL.glGetActiveUniformBlockName(program, index, max_name_length, name_length, name)
return name.value[:int(name_length[0])]
\end{verbatim}}
    \end{itemize}
    \vspace{1em}
    Résumé~:
    \begin{itemize}
    \item une longue histoire
    \item un code source touffue
    \item Python et OpenGL ont évolué
    \item pas d'API de haut niveau pour l'OpenGL moderne % l'API 
    \end{itemize}
  \note{
    \begin{enumerate}
    \item Pourquoi réimplémenter OpenGL
    \end{enumerate}
  }
\end{frame}

%%% Local Variables: 
%%% mode: latex
%%% TeX-master: "master"
%%% End: 
